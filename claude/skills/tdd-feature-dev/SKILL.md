---
name: tdd-feature-dev
description: TDD駆動の機能開発スキル。Markdown要件定義書を読み、テストシナリオ作成→Red-Green-Refactorの流れで実装。要件定義書から機能開発・改修を行う際に使用。
disable-model-invocation: true
---

# TDD Feature Development

## Overview

このスキルは、Markdown形式の要件定義書からテスト駆動開発（TDD）で機能開発・改修を行います。要件定義書を読み込み、テストシナリオを作成し、Red-Green-Refactorサイクルで実装を進めます。

**使用するタイミング:**
- Markdown要件定義書から機能を実装する場合
- TDDで新機能を開発する場合
- 既存機能をテストファーストで改修する場合

## Workflow

このスキルは4つのフェーズで構成されます。

### フェーズ 1: 準備

1. **プロジェクト情報を取得**
   - `AGENTS.md` または `CLAUDE.md` を読み込む
   - プロジェクトの技術スタック、テストフレームワーク、コーディング規約を把握

2. **要件定義書を読み込む**
   - ユーザーから指定されたMarkdownファイルのパスを確認
   - 要件定義書の内容を読み込み、機能要件・受け入れ基準を抽出

**出力:** プロジェクト概要と要件定義の理解内容を報告

### フェーズ 2: テストシナリオ作成

1. **受け入れ基準からテストケースを設計**
   - 単体テスト: 個別関数/メソッドレベル
   - 統合テスト: モジュール間連携レベル

   各テストケースには以下を含める:
   - テストケース名
   - 前提条件
   - 実行手順
   - 期待結果

2. **エッジケース・境界値を検討**
   - 正常系だけでなく異常系も設計
   - 境界値テストケースを追加

3. **ユーザーに確認**
   - `AskUserQuestion`ツールでテストシナリオの妥当性を確認
   - 必要に応じて修正・追加

**出力:** 承認済みテストシナリオ一覧と実行順序

### フェーズ 3: Red-Green-Refactor

各テストケースごとに以下のTDDサイクルを実行します:

#### 🔴 Red: 失敗するテストを書く

1. テストコードを作成
2. テストを実行し、**失敗する**ことを確認
3. 失敗理由が期待通りか検証（未実装エラーなど）

#### 🟢 Green: 最小限の実装でテストを通す

1. テストを通すための最小限のコードを書く
2. テストを実行し、**成功する**ことを確認
3. 全ての既存テストも通ることを確認

#### 🔵 Refactor: コードを整理

1. 重複コードを削除、可読性を向上
2. リファクタリング後にテストを実行
3. 全テストが成功することを確認

**繰り返し:** 全てのテストケースが完了するまでRed-Green-Refactorを繰り返す

### フェーズ 4: 完了

1. **全テスト実行**
   - プロジェクト全体のテストスイートを実行
   - 全テストが成功することを確認

2. **要件との整合性確認**
   - 要件定義書の各項目をチェック
   - 受け入れ基準が全て満たされているか確認

3. **ユーザーに報告**
   - 実装した機能の概要
   - テスト結果サマリー
   - 次のステップの提案（あれば）

**出力:** 完了報告、テスト結果サマリー、変更ファイル一覧

## ベストプラクティス

### テストの粒度
- **単体テスト**: 高速・独立・具体的
- **統合テスト**: 実際の連携を検証

### エラーハンドリング
- エラーケースもテストに含める
- 例外処理は明示的にテスト
- エラーメッセージも検証対象

## Example Usage

**ユーザーリクエスト例:**
```
/tdd-feature-dev docs/requirements/user-auth.md
```

**スキルの動作:**
1. `AGENTS.md`を読み込み、プロジェクトがNode.js + Jestを使用していることを確認
2. `docs/requirements/user-auth.md`から「ユーザー認証機能」の要件を抽出
3. テストシナリオを作成し、ユーザーに確認
4. Red-Green-Refactorサイクルで実装:
   - Red: `auth.test.js`に失敗するテストを書く
   - Green: `auth.js`に最小実装を追加
   - Refactor: コードを整理
5. 全テスト成功を確認し、完了報告
