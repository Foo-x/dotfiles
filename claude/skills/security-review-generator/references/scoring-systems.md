# セキュリティスコアリングシステム

## CVSS v3.1 (Common Vulnerability Scoring System)

### 概要
CVSSは脆弱性の深刻度を0.0～10.0のスコアで評価する業界標準システムです。

### スコア範囲
- **9.0-10.0**: Critical（緊急）
- **7.0-8.9**: High（高）
- **4.0-6.9**: Medium（中）
- **0.1-3.9**: Low（低）
- **0.0**: None（なし）

### Base Metrics（基本評価基準）

#### Attack Vector (AV) - 攻撃元区分
- **Network (N)**: ネットワーク経由（最も危険）
- **Adjacent (A)**: 隣接ネットワーク
- **Local (L)**: ローカルアクセス必要
- **Physical (P)**: 物理アクセス必要

#### Attack Complexity (AC) - 攻撃条件の複雑さ
- **Low (L)**: 特別な条件不要
- **High (H)**: 特別な条件が必要

#### Privileges Required (PR) - 必要な特権レベル
- **None (N)**: 特権不要
- **Low (L)**: 基本的なユーザー権限
- **High (H)**: 管理者権限必要

#### User Interaction (UI) - 利用者の関与
- **None (N)**: 利用者の操作不要
- **Required (R)**: 利用者の操作が必要

#### Scope (S) - 影響範囲
- **Unchanged (U)**: 脆弱なコンポーネントのみ
- **Changed (C)**: 他のコンポーネントにも影響

#### Confidentiality Impact (C) - 機密性への影響
- **None (N)**: 影響なし
- **Low (L)**: 限定的な情報漏洩
- **High (H)**: 全情報漏洩の可能性

#### Integrity Impact (I) - 完全性への影響
- **None (N)**: 影響なし
- **Low (L)**: 限定的な改ざん
- **High (H)**: 全データ改ざんの可能性

#### Availability Impact (A) - 可用性への影響
- **None (N)**: 影響なし
- **Low (L)**: パフォーマンス低下
- **High (H)**: 完全なサービス停止

### CVSS計算例

#### 例1: SQLインジェクション
```
AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

- AV:N (ネットワークから攻撃可能)
- AC:L (複雑な条件不要)
- PR:N (認証不要)
- UI:N (ユーザー操作不要)
- S:C (データベースへの影響)
- C:H (全データ漏洩の可能性)
- I:H (データ改ざん可能)
- A:H (サービス停止可能)

CVSSスコア: 10.0 (Critical)
```

#### 例2: XSS (Stored)
```
AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N

- AV:N (ネットワーク経由)
- AC:L (簡単)
- PR:L (ログイン必要)
- UI:R (被害者のクリック必要)
- S:C (他ユーザーに影響)
- C:L (セッション情報漏洩)
- I:L (限定的な改ざん)
- A:N (可用性への影響なし)

CVSSスコア: 5.4 (Medium)
```

#### 例3: CSRF
```
AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

- AV:N (ネットワーク経由)
- AC:L (簡単)
- PR:N (認証不要、被害者が認証済み)
- UI:R (被害者のクリック必要)
- S:U (範囲は変わらない)
- C:H (データ漏洩の可能性)
- I:H (データ改ざん可能)
- A:H (アカウント削除可能)

CVSSスコア: 8.8 (High)
```

### オンライン計算ツール
- [FIRST CVSS Calculator](https://www.first.org/cvss/calculator/3.1)
- [NVD CVSS Calculator](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

---

## DREAD (Microsoft)

### 概要
DREADはリスクを5つの要素で評価するシステムです（各0-10点）。

### 評価項目

#### D - Damage Potential (損害の可能性)
- **10**: 完全なシステム侵害
- **7-9**: 重要な情報漏洩
- **4-6**: 個人情報の漏洩
- **1-3**: 限定的な情報漏洩
- **0**: 損害なし

#### R - Reproducibility (再現性)
- **10**: 常に再現可能
- **7-9**: 高確率で再現可能
- **4-6**: 時々再現可能
- **1-3**: 再現困難
- **0**: 再現不可能

#### E - Exploitability (悪用の容易さ)
- **10**: 初心者でも悪用可能
- **7-9**: 熟練した攻撃者なら可能
- **4-6**: 高度なスキルが必要
- **1-3**: 非常に高度なスキルが必要
- **0**: 理論的にのみ可能

#### A - Affected Users (影響を受けるユーザー)
- **10**: 全ユーザー
- **7-9**: 大多数のユーザー
- **4-6**: 一部のユーザー
- **1-3**: 少数のユーザー
- **0**: 管理者のみ

#### D - Discoverability (発見の容易さ)
- **10**: 明白、自動ツールで発見可能
- **7-9**: 簡単に発見可能
- **4-6**: 発見には努力が必要
- **1-3**: 発見困難
- **0**: 実質的に不可能

### DREAD計算

```
DREADスコア = (D + R + E + A + D) / 5

リスクレベル:
- 8.0-10.0: Critical
- 6.0-7.9: High
- 4.0-5.9: Medium
- 0.0-3.9: Low
```

### DREAD評価例

#### 例1: SQLインジェクション
```
D: 10 (完全なデータベース侵害)
R: 10 (常に再現可能)
E: 8  (中級者でも悪用可能)
A: 10 (全ユーザーに影響)
D: 9  (自動スキャナーで発見可能)

DREADスコア: (10+10+8+10+9)/5 = 9.4 (Critical)
```

#### 例2: XSS (Reflected)
```
D: 6  (セッション乗っ取り)
R: 8  (高確率で再現)
E: 7  (中級者なら可能)
A: 5  (リンクをクリックしたユーザーのみ)
D: 7  (比較的簡単に発見)

DREADスコア: (6+8+7+5+7)/5 = 6.6 (High)
```

---

## ビジネス影響度評価

### CIA Triad評価

#### Confidentiality (機密性)
- **Critical**: 企業秘密、顧客の金融情報
- **High**: 個人識別情報（PII）
- **Medium**: 内部文書
- **Low**: 公開情報

#### Integrity (完全性)
- **Critical**: 金融トランザクション
- **High**: 顧客データ
- **Medium**: 設定ファイル
- **Low**: ログファイル

#### Availability (可用性)
- **Critical**: 決済システム（SLA 99.99%）
- **High**: Webサービス（SLA 99.9%）
- **Medium**: 管理画面（SLA 99%）
- **Low**: レポート機能（SLA 95%）

### 財務影響評価

```markdown
## 財務影響計算

### データ漏洩
- 1レコードあたりのコスト: $150
- 漏洩レコード数: 100,000
- 直接コスト: $15,000,000

### 追加コスト
- 規制罰金（GDPR）: $20,000,000
- 訴訟費用: $5,000,000
- 評判損失: $10,000,000
- インシデント対応: $2,000,000

### 総コスト: $52,000,000
```

### SLA影響評価

```markdown
## ダウンタイム影響

### サービス停止
- 時間あたり収益: $100,000
- ダウンタイム: 4時間
- 収益損失: $400,000

### SLA違反
- 返金額: $50,000
- 顧客離脱: 5%
- LTV損失: $1,000,000

### 総影響: $1,450,000
```

---

## コスト vs リスク ROI分析

### 対策コスト計算

```markdown
## 対策実装コスト

### 初期コスト
- 開発工数: 200時間 × $100/時間 = $20,000
- ツール導入: $10,000
- トレーニング: $5,000
**小計: $35,000**

### 継続コスト（年間）
- 保守: $5,000
- ライセンス: $3,000
- 監視: $2,000
**小計: $10,000**

### 3年間の総コスト: $65,000
```

### ROI計算

```
ROI = (リスク軽減額 - 対策コスト) / 対策コスト × 100%

例:
- 潜在的損失: $52,000,000
- リスク軽減率: 95%
- リスク軽減額: $49,400,000
- 対策コスト: $65,000

ROI = ($49,400,000 - $65,000) / $65,000 × 100%
    = 75,900%

費用対効果: 1:760（1ドル投資で760ドルのリスク軽減）
```

### 優先度マトリクス

```
              対策コスト
           Low    Med    High
リスク  High   P1     P1     P2
       Med    P2     P2     P3
       Low    P3     P3     P4

P1: 即座に対応（1週間以内）
P2: 短期対応（1ヶ月以内）
P3: 中期対応（3ヶ月以内）
P4: 長期対応（6ヶ月以内）
```

---

## 統合リスク評価テンプレート

```markdown
# リスク評価レポート: [脆弱性名]

## 基本情報
- **ID**: VUL-001
- **タイトル**: SQLインジェクション
- **発見日**: 2024-01-15
- **ステータス**: Open

## スコアリング

### CVSS v3.1
- **ベクター**: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
- **スコア**: 10.0 (Critical)

### DREAD
- Damage: 10
- Reproducibility: 10
- Exploitability: 8
- Affected Users: 10
- Discoverability: 9
- **スコア**: 9.4 (Critical)

## ビジネス影響

### CIA評価
- Confidentiality: Critical
- Integrity: Critical
- Availability: High

### 財務影響
- 潜在的損失: $52,000,000
- ダウンタイム影響: $1,450,000
- **総影響**: $53,450,000

## 対策とROI

### 推奨対策
1. パラメータ化クエリの実装
2. 入力検証の強化
3. WAF導入

### 対策コスト
- 初期: $35,000
- 継続（年間）: $10,000
- **3年間総コスト**: $65,000

### ROI
- リスク軽減額: $50,777,500 (95%軽減)
- **ROI**: 78,000%
- **費用対効果**: 1:781

## 優先度
**P0 - 即座に対応必須**

## アクション
- [ ] 開発チームへのエスカレーション
- [ ] 2週間以内の修正完了
- [ ] ペネトレーションテストでの検証
```

## 参考資料

- [CVSS v3.1 Specification](https://www.first.org/cvss/v3.1/specification-document)
- [NIST Risk Management Framework](https://csrc.nist.gov/projects/risk-management)
