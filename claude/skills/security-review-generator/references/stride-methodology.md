# STRIDE 脅威モデリング手法

STRIDEは、Microsoft が開発した脅威モデリングフレームワークで、システムの脅威を6つのカテゴリに分類します。

## STRIDE カテゴリ

### S - Spoofing (なりすまし)

**定義:** 攻撃者が他のユーザーやシステムになりすます脅威

**脅威例:**
- ユーザー認証情報の盗用、セッションハイジャック
- IPアドレス偽装、メールアドレス偽装、証明書偽造

**チェックポイント:**
- 多要素認証（MFA）の実装
- セッショントークンの暗号学的ランダム性
- 証明書検証、送信元検証
- アンチスプーフィング対策

**対策:** 強力な認証メカニズム（MFA、生体認証）、相互TLS認証、デジタル署名、セキュアなセッション管理

---

### T - Tampering (改ざん)

**定義:** データやコードの不正な変更

**脅威例:**
- データベースの不正変更、通信データの改ざん
- ファイルの改ざん、ログの改ざん、設定ファイルの変更

**チェックポイント:**
- データ整合性の検証（ハッシュ、デジタル署名）
- 通信の暗号化（TLS）
- ファイルの整合性モニタリング
- 監査ログの保護
- 書き込み権限の最小化

**対策:** デジタル署名、ハッシュ値による整合性チェック、TLS/SSL通信、ファイル整合性モニタリング（FIM）、アクセス制御リスト（ACL）

---

### R - Repudiation (否認)

**定義:** 行動の証拠を否定できる脅威

**脅威例:**
- トランザクションの否認、監査ログの欠如
- ログの改ざん、非デジタル署名トランザクション、タイムスタンプの欠如

**チェックポイント:**
- 包括的な監査ログ
- ログの改ざん防止
- デジタル署名
- タイムスタンプ
- 否認防止メカニズム

**対策:** 改ざん防止ログ（Append-only、署名）、デジタル署名、信頼できるタイムスタンプ、SIEM、ブロックチェーン技術

---

### I - Information Disclosure (情報漏洩)

**定義:** 権限のないユーザーへの情報公開

**脅威例:**
- データベースの露出、APIからの過剰な情報返却
- エラーメッセージでの情報漏洩、ソースコードの露出
- 機密ファイルの公開、メタデータの漏洩

**チェックポイント:**
- エラーメッセージのサニタイズ
- データの最小化（必要最小限のみ返却）
- 機密データの暗号化
- アクセス制御
- セキュリティヘッダー設定

**対策:** データ分類と最小化、暗号化（保存時、通信時）、汎用的なエラーメッセージ、セキュリティヘッダー、ディレクトリリスティング無効化、デバッグモード無効化（本番環境）

---

### D - Denial of Service (サービス拒否)

**定義:** システムの可用性を低下させる脅威

**脅威例:**
- リソース枯渇攻撃、アプリケーション層DoS
- ネットワーク層DoS/DDoS、正規表現DoS（ReDoS）
- XML Bomb、Zip Bomb

**チェックポイント:**
- レート制限
- リソース制限（CPU、メモリ、ストレージ）
- タイムアウト設定
- 入力サイズ制限
- DDoS対策（CDN、WAF）

**対策:** レート制限、リソース割り当て制限、タイムアウト設定、入力検証、CDN/WAF、Auto-scaling、Circuit Breaker パターン

---

### E - Elevation of Privilege (権限昇格)

**定義:** 権限のないユーザーが高い権限を取得する脅威

**脅威例:**
- 垂直権限昇格（一般ユーザーから管理者へ）
- 水平権限昇格（他ユーザーのリソースへアクセス）
- SQLインジェクションによる権限変更
- 認可チェックのバイパス

**チェックポイント:**
- すべてのリソースアクセスで認可チェック
- 最小権限の原則
- 役割ベースアクセス制御（RBAC）
- 入力検証
- セキュアな設定管理

**対策:** RBAC、最小権限の原則、すべてのエンドポイントでの認可チェック、入力検証、セキュアなデフォルト設定

---

## STRIDEとセキュリティプロパティのマッピング

| STRIDE | 侵害されるプロパティ | 対策の焦点 |
|--------|------------------|----------|
| Spoofing | 認証 (Authentication) | 強力な認証メカニズム |
| Tampering | 完全性 (Integrity) | ハッシュ、署名、暗号化 |
| Repudiation | 否認防止 (Non-repudiation) | ログ、監査証跡 |
| Information Disclosure | 機密性 (Confidentiality) | 暗号化、アクセス制御 |
| Denial of Service | 可用性 (Availability) | リソース管理、冗長性 |
| Elevation of Privilege | 認可 (Authorization) | RBAC、最小権限 |

## STRIDE分析テンプレート

```markdown
# STRIDE分析: [コンポーネント名]

## Spoofing
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low

## Tampering
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low

## Repudiation
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low

## Information Disclosure
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low

## Denial of Service
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low

## Elevation of Privilege
- 脅威: [具体的な脅威]
- 現在の対策: [既存の対策]
- 推奨対策: [追加すべき対策]
- 優先度: High/Medium/Low
```
